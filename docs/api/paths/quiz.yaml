# Quiz API Endpoints

startQuiz:
  post:
    tags:
      - Quiz
    summary: Start a new career assessment quiz
    description: |
      Initialize a new adaptive career assessment quiz session. The quiz uses AI to generate personalized questions based on user responses and progresses through multiple stages: interests, skills, values, goals, and preferences.
      
      **Features:**
      - AI-powered adaptive questioning
      - Multi-stage career assessment
      - Domain-specific question sets
      - Progressive difficulty adjustment
      
      **Rate Limiting:** 15 actions per 2 minutes per user
    operationId: startQuiz
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas.yaml#/QuizStartRequest'
          examples:
            general_quiz:
              summary: General career assessment
              value:
                userId: "user_12345"
            domain_specific:
              summary: Technology-focused assessment
              value:
                userId: "user_12345"
                domain: "TECHNOLOGY"
    responses:
      '201':
        description: Quiz session created successfully
        headers:
          X-RateLimit-Remaining:
            description: Number of requests remaining in current window
            schema:
              type: integer
              example: 14
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas.yaml#/ApiResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        session:
                          $ref: '../components/schemas.yaml#/QuizSession'
                        currentQuestion:
                          $ref: '../components/schemas.yaml#/QuizQuestion'
            example:
              status: success
              message: Quiz session created successfully
              data:
                session:
                  id: "quiz_abc123"
                  userId: "user_12345"
                  stage: "INTERESTS"
                  currentQuestion: 1
                  answers: []
                  isComplete: false
                  createdAt: "2025-07-21T05:30:00Z"
                currentQuestion:
                  id: "q_interests_1"
                  text: "What type of work environment energizes you most?"
                  type: "multiple_choice"
                  options:
                    - "Fast-paced startup environment"
                    - "Large corporate structure"
                    - "Remote/flexible work arrangement"
                    - "Team-based collaborative space"
                    - "Independent/solo work setting"
                  stage: "INTERESTS"
              timestamp: "2025-07-21T05:30:00Z"
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/ErrorResponse'
            example:
              status: error
              message: User not found
              data:
                errorCode: USER_NOT_FOUND
      '429':
        $ref: '../components/responses.yaml#/RateLimited'
      '500':
        $ref: '../components/responses.yaml#/InternalServerError'

submitAnswer:
  post:
    tags:
      - Quiz
    summary: Submit answer to current quiz question
    description: |
      Submit an answer to the current quiz question and receive the next question or quiz results if completed.
      
      **Features:**
      - Intelligent question progression
      - AI-driven next question selection
      - Stage advancement based on responses
      - Real-time career insights
      
      **Rate Limiting:** 15 actions per 2 minutes per user
    operationId: submitQuizAnswer
    parameters:
      - name: quizId
        in: path
        required: true
        description: Unique quiz session identifier
        schema:
          type: string
          pattern: '^[a-zA-Z0-9_-]+$'
        example: "quiz_abc123"
    requestBody:
      required: true
      content:
        application/json:
          schema:
            $ref: '../components/schemas.yaml#/QuizAnswerRequest'
          examples:
            multiple_choice_answer:
              summary: Multiple choice answer
              value:
                answer: "Fast-paced startup environment"
            open_ended_answer:
              summary: Open-ended response
              value:
                answer: "I enjoy solving complex problems and building software applications that help people in their daily lives"
            rating_answer:
              summary: Rating scale answer
              value:
                answer: "8"
    responses:
      '200':
        description: Answer submitted successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas.yaml#/ApiResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        session:
                          $ref: '../components/schemas.yaml#/QuizSession'
                        nextQuestion:
                          $ref: '../components/schemas.yaml#/QuizQuestion'
                        progress:
                          type: object
                          properties:
                            stage:
                              type: string
                              example: "INTERESTS"
                            completion:
                              type: number
                              format: float
                              example: 0.25
                            questionsAnswered:
                              type: integer
                              example: 3
                        insights:
                          type: object
                          description: Real-time insights based on answers so far
                          properties:
                            dominantInterests:
                              type: array
                              items:
                                type: string
                              example: ["Problem Solving", "Technology", "Innovation"]
                            suggestedPaths:
                              type: array
                              items:
                                type: string
                              example: ["Software Engineering", "Data Science", "Product Management"]
            examples:
              next_question:
                summary: Next question in same stage
                value:
                  status: success
                  message: Answer recorded successfully
                  data:
                    session:
                      id: "quiz_abc123"
                      userId: "user_12345"
                      stage: "INTERESTS"
                      currentQuestion: 2
                      answers:
                        - question: "What type of work environment energizes you most?"
                          answer: "Fast-paced startup environment"
                          timestamp: "2025-07-21T05:30:00Z"
                      isComplete: false
                    nextQuestion:
                      id: "q_interests_2"
                      text: "Which activities do you find most engaging?"
                      type: "multiple_choice"
                      options:
                        - "Analyzing data and finding patterns"
                        - "Creating visual designs and user experiences"
                        - "Writing and communicating ideas"
                        - "Leading teams and making strategic decisions"
                        - "Building and fixing technical systems"
                      stage: "INTERESTS"
                    progress:
                      stage: "INTERESTS"
                      completion: 0.1
                      questionsAnswered: 1
                    insights:
                      dominantInterests: ["Innovation", "Fast-paced Environment"]
                      suggestedPaths: ["Technology Startup", "Product Development"]
              quiz_completed:
                summary: Quiz completion with results
                value:
                  status: success
                  message: Quiz completed successfully
                  data:
                    session:
                      id: "quiz_abc123"
                      userId: "user_12345"
                      stage: "COMPLETE"
                      currentQuestion: 20
                      isComplete: true
                      results:
                        careerSuggestions:
                          - title: "Software Engineer"
                            match: 0.92
                            reasons:
                              - "Strong problem-solving orientation"
                              - "Technology interest alignment"
                              - "Startup environment preference"
                          - title: "Product Manager"
                            match: 0.85
                            reasons:
                              - "Strategic thinking abilities"
                              - "Cross-functional collaboration skills"
                        skillGaps:
                          - "Programming fundamentals"
                          - "System design knowledge"
                        nextSteps:
                          - "Learn a programming language (Python/JavaScript)"
                          - "Build portfolio projects"
                          - "Network with software engineers"
                    progress:
                      stage: "COMPLETE"
                      completion: 1.0
                      questionsAnswered: 20
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '404':
        description: Quiz session not found
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/ErrorResponse'
            example:
              status: error
              message: Quiz session not found
              data:
                errorCode: QUIZ_NOT_FOUND
      '429':
        $ref: '../components/responses.yaml#/RateLimited'
      '500':
        $ref: '../components/responses.yaml#/InternalServerError'

getSession:
  get:
    tags:
      - Quiz
    summary: Get quiz session details
    description: |
      Retrieve complete details of a quiz session including all answers, current progress, and results if completed.
      
      **Features:**
      - Complete session history
      - Progress tracking
      - Results and insights
    operationId: getQuizSession
    parameters:
      - name: sessionId
        in: path
        required: true
        description: Unique quiz session identifier
        schema:
          type: string
          pattern: '^[a-zA-Z0-9_-]+$'
        example: "quiz_abc123"
    responses:
      '200':
        description: Quiz session retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas.yaml#/ApiResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        session:
                          $ref: '../components/schemas.yaml#/QuizSession'
            example:
              status: success
              message: Quiz session retrieved successfully
              data:
                session:
                  id: "quiz_abc123"
                  userId: "user_12345"
                  stage: "SKILLS"
                  currentQuestion: 8
                  answers:
                    - question: "What type of work environment energizes you most?"
                      answer: "Fast-paced startup environment"
                      timestamp: "2025-07-21T05:30:00Z"
                    - question: "Which activities do you find most engaging?"
                      answer: "Building and fixing technical systems"
                      timestamp: "2025-07-21T05:31:00Z"
                  isComplete: false
                  createdAt: "2025-07-21T05:30:00Z"
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '404':
        description: Quiz session not found
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/ErrorResponse'
            example:
              status: error
              message: Quiz session not found
              data:
                errorCode: QUIZ_NOT_FOUND
      '500':
        $ref: '../components/responses.yaml#/InternalServerError'

getUserSessions:
  get:
    tags:
      - Quiz
    summary: Get user's quiz sessions
    description: |
      Retrieve all quiz sessions for a specific user, including completed and in-progress sessions.
      
      **Features:**
      - Paginated results
      - Session filtering options
      - Progress indicators
    operationId: getUserQuizSessions
    parameters:
      - name: userId
        in: path
        required: true
        description: Unique user identifier
        schema:
          type: string
          pattern: '^[a-zA-Z0-9_-]+$'
        example: "user_12345"
      - name: page
        in: query
        description: Page number for pagination (1-based)
        schema:
          type: integer
          minimum: 1
          default: 1
        example: 1
      - name: limit
        in: query
        description: Number of sessions per page
        schema:
          type: integer
          minimum: 1
          maximum: 50
          default: 10
        example: 10
      - name: completed
        in: query
        description: Filter by completion status
        schema:
          type: boolean
        example: true
    responses:
      '200':
        description: Quiz sessions retrieved successfully
        content:
          application/json:
            schema:
              allOf:
                - $ref: '../components/schemas.yaml#/ApiResponse'
                - type: object
                  properties:
                    data:
                      type: object
                      properties:
                        sessions:
                          type: array
                          items:
                            $ref: '../components/schemas.yaml#/QuizSession'
                        pagination:
                          type: object
                          properties:
                            page:
                              type: integer
                            limit:
                              type: integer
                            totalPages:
                              type: integer
                            totalSessions:
                              type: integer
            example:
              status: success
              message: Quiz sessions retrieved successfully
              data:
                sessions:
                  - id: "quiz_abc123"
                    userId: "user_12345"
                    stage: "COMPLETE"
                    currentQuestion: 20
                    isComplete: true
                    createdAt: "2025-07-21T05:30:00Z"
                  - id: "quiz_def456"
                    userId: "user_12345"
                    stage: "SKILLS"
                    currentQuestion: 8
                    isComplete: false
                    createdAt: "2025-07-20T14:15:00Z"
                pagination:
                  page: 1
                  limit: 10
                  totalPages: 1
                  totalSessions: 2
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '404':
        description: User not found
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/ErrorResponse'
            example:
              status: error
              message: User not found
              data:
                errorCode: USER_NOT_FOUND
      '500':
        $ref: '../components/responses.yaml#/InternalServerError'

deleteSession:
  delete:
    tags:
      - Quiz
    summary: Delete a quiz session
    description: |
      Permanently delete a quiz session and all associated data. This action cannot be undone.
      
      **Features:**
      - Complete data removal
      - Confirmation required
      - Audit trail maintained
    operationId: deleteQuizSession
    parameters:
      - name: sessionId
        in: path
        required: true
        description: Unique quiz session identifier
        schema:
          type: string
          pattern: '^[a-zA-Z0-9_-]+$'
        example: "quiz_abc123"
    responses:
      '200':
        description: Quiz session deleted successfully
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/ApiResponse'
            example:
              status: success
              message: Quiz session deleted successfully
              data:
                sessionId: "quiz_abc123"
                deletedAt: "2025-07-21T05:45:00Z"
      '400':
        $ref: '../components/responses.yaml#/BadRequest'
      '404':
        description: Quiz session not found
        content:
          application/json:
            schema:
              $ref: '../components/schemas.yaml#/ErrorResponse'
            example:
              status: error
              message: Quiz session not found
              data:
                errorCode: QUIZ_NOT_FOUND
      '500':
        $ref: '../components/responses.yaml#/InternalServerError'
